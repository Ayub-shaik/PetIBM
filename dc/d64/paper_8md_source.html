<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>PetIBM: paper.md Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PetIBM
   &#160;<span id="projectnumber">0.3.1</span>
   </div>
   <div id="projectbrief">Toolbox and applications of the immersed-boundary method for distributed-memory architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../md_CHANGELOG.html"><span>Change&#160;Log</span></a></li>
      <li><a href="../../md_CONTRIBUTING.html"><span>Contributing</span></a></li>
      <li><a href="../../usergroup0.html"><span>Quick&#160;Start</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/d64/paper_8md.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">paper.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/d64/paper_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;---</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;title: &#39;PetIBM: toolbox and applications of the immersed-boundary method on distributed-memory architectures&#39;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;tags:</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  - Computational Fluid Dynamics</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  - Immersed-Boundary Method</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  - PETSc</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  - GPU</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  - NVIDIA AmgX</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;authors:</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; - name: Pi-Yueh Chuang</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;   orcid: 0000-0001-6330-2709</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;   affiliation: 1</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; - name: Olivier Mesnard</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;   orcid: 0000-0001-5335-7853</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;   affiliation: 1</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; - name: Anush Krishnan</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;   orcid: 0000-0001-6409-7022</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   affiliation: 2</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; - name: Lorena A. Barba</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   orcid: 0000-0001-5812-2711</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   affiliation: 1</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;affiliations:</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; - name: Department of Mechanical and Aerospace Engineering, The George Washington University, Washington, DC, USA</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   index: 1</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; - name: nuTonomy Inc., Cambridge, MA, USA (previously at Boston University)</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   index: 2</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;date: 25 January 2018</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;bibliography: paper.bib</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;---</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;# Summary</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;PetIBM is a C++ library with ready-to-use application codes to solve the two- and three-dimensional incompressible Navier-Stokes equations on fixed structured Cartesian grids with an immersed-boundary method (IBM).</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;PetIBM runs on distributed-memory architectures and can be used to compute the flow around multiple moving rigid immersed boundaries (with prescribed kinematics).</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;In the IBM framework, a collection of Lagrangian markers defines the immersed boundary (where boundary conditions are enforced) and the fluid equations are solved over the extended domain (including the body domain).</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;The Eulerian mesh remains unmodified when computing the flow around multiple moving immersed bodies, which removes the need for remeshing at every time step.</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;PetIBM discretizes the fluid equations using a second-order finite-difference scheme, various optional time-integrators, and a fully discrete projection method (@perot_1993).</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;It implements two immersed-boundary algorithms: the immersed-boundary projection method (@taira_colonius_2007) and its decoupled version (@li_et_al_2016).</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;Other open-source software packages offer immersed-boundary solvers: for example, IBAMR (@griffith_et_al_2007, @bhalla_et_al_2013) is a long-standing C++ library with MPI parallelization that also provides adaptive mesh refinement.</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;It can handle deforming immersed bodies and has been used in a variety of scenarios, including cardiac fluid dynamics, swimming, insect flight, and others.</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;PetIBM and IBAMR use different immersed-boundary schemes, however. We developed PetIBM to work with the immersed-boundary projection method, which is based on the fully discrete formulation of Perot on staggered grids and thus eliminates the need for pressure boundary conditions, which have caused many headaches for CFD practitioners (@gresho_sani_1987, @sani_gresho_1994).</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;PetIBM features an operator-based design, providing routines to create and manipulate discrete operators (e.g., gradient, divergence, Laplacian, convection, diffusion, etc.), so it can be used as a toolbox for researching new solution methods.</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;It is also capable of using graphics processing unit (GPU) architectures, a feature missing from other software, as far as we know.</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;A previous project implementing immersed-boundary methods on GPU architecture is cuIBM (@krishnan_et_al_2017), but it is limited to two-dimensional problems that fit on a single GPU device.</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;PetIBM is written in C++ and relies on the PETSc library (@petsc_1997, @petsc_user_ref_2017) for data structures and parallel routines to run on memory-distributed architectures.</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;PetIBM can solve one or several linear systems on multiple distributed CUDA-capable GPU devices with the NVIDIA AmgX library and AmgXWrapper (@chuang_barba_2017).</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;The software package includes extended documentation as well as many examples to guide users.</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;PetIBM has already been used to generate results published in @mesnard_barba_2017, a full replication of a study on the aerodynamics of a gliding snake species (@krishnan_et_al_2014).</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;PetIBM is currently used to compute the three-dimensional flow of a gliding-snake model on the cloud platform Microsoft Azure.</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;## Appendix: mathematical formulation</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;PetIBM solves the Navier-Stokes equations on an extended discretization grid that includes the interior of the immersed boundary.</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;To model the presence of the boundary, a forcing term is added to the momentum equation and an additional equation for the no-slip condition completes the system.</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;Variants of the immersed-boundary method (IBM) depend on how one models the forcing.</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;In PetIBM, we use regularized-delta functions to transfer data between the Eulerian grid and the Lagrangian boundary points.</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;The system of equations is:</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;\begin{equation}</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;\begin{cases}</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;\frac{\partial \mathbf{u}}{\partial t} + \mathbf{u} \cdot \nabla \mathbf{u} = -\nabla p + \frac{1}{Re} \nabla^2 \mathbf{u} + \int_{s}{\mathbf{f} \left( \mathbf{\xi} \left( \mathit{s}, \mathit{t} \right) \right) \delta \left( \mathbf{\xi} - \mathbf{x} \right)} d\mathit{s} \\</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;\nabla \cdot \mathbf{u} = 0 \\</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;\mathbf{u} \left( \mathbf{\xi} \left( \mathit{s}, t \right) \right) = \int_{\mathbf{x}}{\mathbf{u} \left( \mathbf{x} \right)} \delta \left( \mathbf{x} - \mathbf{\xi} \right) d\mathbf{x}</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;\end{cases}</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;\end{equation}</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;where $\mathbf{u}$ is the velocity field, $p$ is the fluid pressure, and $Re$ is the Reynolds number.</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;Currently, PetIBM provides two application codes implementing different versions of the IBM: (1) an immersed-boundary projection method (IBPM) based on the work of @taira_colonius_2007 and (2) a decoupled version of the IBPM proposed by @li_et_al_2016.</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;Those two methods fit into the framework of the projection approach of @perot_1993.</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;The equations are fully discretized (space and time) to form an algebraic system to be solved for the velocity $u^{n+1}$, the pressure field $\phi$, and the Lagrangian forces $\tilde{f}$.</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;The discretized system is:</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;\begin{equation}</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;\left[</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;\begin{matrix}</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;A &amp; G &amp; H \\</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;D &amp; 0 &amp; 0 \\</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;E &amp; 0 &amp; 0</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;\end{matrix}</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;\right]</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;\left(</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;\begin{matrix}</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;u^{n+1} \\</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;\phi \\</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;\tilde{f}</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;\end{matrix}</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;\right)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;=</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;\left(</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;\begin{matrix}</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;r^n \\</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;0 \\</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;u_B^{n+1}</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;\end{matrix}</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;\right)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;+</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;\left(</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;\begin{matrix}</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;bc_1 \\</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;bc_2 \\</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;0</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;\end{matrix}</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;\right)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;\end{equation}</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;where $D$, $G$, and $A$ are the divergence, gradient, and implicit operators, respectively.</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;$E$ and $H$ are the interpolation and spreading operators, respectively, used to transfer the data between the Eulerian grid and the Lagrangian boundary points.</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;On the right-hand side, $r^n$ gathers all the explicit terms and $u_B^{n+1}$ is the known (prescribed) boundary velocity; $bc_1$ and $bc_2$ contain the boundary terms that arise from the discretization of momentum and continuity equations, respectively.</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;In the IBPM, we solve a modified Poisson system for the pressure field and Lagrangian forces, coupled together.</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;This way, the divergence-free condition and no-slip constraint are simultaneously enforced on the velocity field at the end of the time step.</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;The fully discretized system can be cast into the following:</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;\begin{equation}</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;\left[</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;\begin{matrix}</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;A &amp; Q_2 \\</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;Q_1 &amp; 0</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;\end{matrix}</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;\right]</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;\left(</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;\begin{matrix}</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;u^{n+1} \\</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;\lambda</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;\end{matrix}</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;\right)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;=</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;\left(</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;\begin{matrix}</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;r_1 \\</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;r_2</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;\end{matrix}</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;\right)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;\end{equation}</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;with</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;\begin{equation*}</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;Q_1 \equiv \left[ \begin{matrix} D \\ E \end{matrix} \right] ;\</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;Q_2 \equiv \left[ G, H \right] ;\</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;\lambda \equiv \left( \begin{matrix} \phi \\ \tilde{f} \end{matrix} \right) ;\</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;r_1 \equiv r^n + bc_1 ;\</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;r_2 \equiv \left( \begin{matrix} bc_2 \\ u_B^{n+1} \end{matrix} \right)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;\end{equation*}</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;In practice, we never form the full system.</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;Instead, we apply a block-LU decomposition as follows:</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;\begin{equation}</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;\left[</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;\begin{matrix}</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;A &amp; 0 \\</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;Q_1 &amp; -Q_1A^{-1}Q_2</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;\end{matrix}</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;\right]</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;\left[</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;\begin{matrix}</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;I &amp; A^{-1}Q_2 \\</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;0 &amp; I</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;\end{matrix}</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;\right]</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;\left(</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;\begin{matrix}</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;u^{n+1} \\</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;\lambda</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;\end{matrix}</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;\right)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;=</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;\left[</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;\begin{matrix}</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;A &amp; 0 \\</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;Q_1 &amp; -Q_1A^{-1}Q_2</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;\end{matrix}</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;\right]</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;\left(</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;\begin{matrix}</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;u^* \\</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;\lambda</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;\end{matrix}</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;\right)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;=</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;\left(</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;\begin{matrix}</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;r_1 \\</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;r_2</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;\end{matrix}</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;\right)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;\end{equation}</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;Thus, we retrieve the sequence of operations of the traditional projection method.</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;We solve a system for an intermediate velocity field that is corrected, after solving a modified Poisson system for the variable $\lambda$, to enforce the divergence-free condition and the no-slip constraint at the location of the immersed boundary.</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;The sequence is:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;\begin{align}</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;&amp; A u^* = r_1 \\</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;&amp; Q_1A^{-1}Q_2 \lambda = Q_1 u^* - r_2 \\</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;&amp; u^{n+1} = u^* - A^{-1}Q_1 \lambda</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;\end{align}</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;The IBPM implemented in PetIBM solves, at every time step, Equations (5) to (6).</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;(Note: the inverse of the implicit operator $A^{-1}$ is approximated by a finite Taylor series expansion.)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;The IBPM requires solving, at each time step, an expensive modified Poisson system, $Q_1A^{-1}Q_2$, whose non-zero structure changes when the location of the immersed boundary is moving.</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;In the PetIBM implementation of the decoupled IBPM, we apply a second block-LU decomposition to decouple the pressure field from the Lagrangian forces and recover a classical Poisson system.</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;The fully discretized algebraic system can be cast into:</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;\begin{equation}</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;\left[</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;\begin{matrix}</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;A &amp; H &amp; G \\</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;E &amp; 0 &amp; 0 \\</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;D &amp; 0 &amp; 0</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;\end{matrix}</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;\right]</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;\left(</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;\begin{matrix}</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;u^{n+1} \\</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;\tilde{f} \\</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;\phi</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;\end{matrix}</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;\right)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;=</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;\left(</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;\begin{matrix}</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;r^n \\</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;u_B^{n+1} \\</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;0</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;\end{matrix}</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;\right)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;+</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;\left(</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;\begin{matrix}</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;bc_1 \\</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;0 \\</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;bc_2</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;\end{matrix}</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;\right)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;\end{equation}</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;The velocity $u^{n+1}$ and the Lagrangian forces $\tilde{f}$ are coupled together to form a new unknown $\gamma^{n+1}$, as follows:</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;\begin{equation}</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;\left[</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;\begin{matrix}</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;\bar{A} &amp; \bar{G} \\</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;\bar{D} &amp; 0</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;\end{matrix}</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;\right]</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;\left(</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;\begin{matrix}</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;\gamma^{n+1} \\</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;\phi</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;\end{matrix}</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;\right)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;=</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;\left(</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;\begin{matrix}</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;\bar{r_1} \\</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;\bar{r_2}</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;\end{matrix}</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;\right)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;\end{equation}</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;where</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;\begin{equation*}</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;\bar{A} \equiv \left[ \begin{matrix} A &amp; H \\ E &amp; 0 \end{matrix} \right] ;\</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;\bar{G} \equiv \left[ \begin{matrix} G \\ 0 \end{matrix} \right] ;\</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;\bar{D} \equiv \left[ \begin{matrix} D &amp; 0 \end{matrix} \right]</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;\end{equation*}</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;and</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;\begin{equation*}</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;\gamma^{n+1} \equiv \left( \begin{matrix} u^{n+1} \\ \tilde{f} \end{matrix}\right) ;\</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;\bar{r_1} \equiv \left( \begin{matrix} r_n + bc_1 \\ u_B^{n+1} \end{matrix}\right) ;\</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;\bar{r_2} \equiv bc_2</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;\end{equation*}</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;Two successive block-LU decompositions are applied to decouple the Lagrangian forces $\tilde{f}$ from $\gamma^{n+1}$ and to decouple the velocity from the pressure field.</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;The first block-LU decomposition decouples the pressure field from the new unknown $\gamma^{n+1}$:</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;\begin{equation}</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;\left[</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;\begin{matrix}</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;\bar{A} &amp; 0 \\</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;\bar{D} &amp; -\bar{D}\bar{A}^{-1}\bar{G}</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;\end{matrix}</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;\right]</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;\left[</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;\begin{matrix}</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;I &amp; \bar{A}^{-1}\bar{G} \\</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;0 &amp; I</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;\end{matrix}</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;\right]</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;\left(</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;\begin{matrix}</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;\gamma^{n+1} \\</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;\phi</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;\end{matrix}</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;\right)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;=</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;\left[</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;\begin{matrix}</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;\bar{A} &amp; 0 \\</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;\bar{D} &amp; -\bar{D}\bar{A}^{-1}\bar{G}</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;\end{matrix}</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;\right]</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;\left(</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;\begin{matrix}</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;\gamma^* \\</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;\phi</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;\end{matrix}</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;\right)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;=</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;\left(</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;\begin{matrix}</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;\bar{r_1} \\</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;\bar{r_2}</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;\end{matrix}</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;\right)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;\end{equation}</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;which leads to the following sequence of operations:</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;\begin{align}</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;&amp; \bar{A} \gamma^* = \bar{r_1} \\</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;&amp; \bar{D}\bar{A}^{-1}\bar{G} \phi = \bar{D} \gamma^* - \bar{r_2} \\</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;&amp; \gamma^{n+1} = \gamma^* - \bar{A}^{-1}\bar{G} \phi</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;\end{align}</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;A second block-LU decomposition is applied to the first equation above:</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;\begin{equation}</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;\left[</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;\begin{matrix}</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;A &amp; 0 \\</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;E &amp; -EA^{-1}H</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;\end{matrix}</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;\right]</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;\left[</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;\begin{matrix}</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;I &amp; A^{-1}H \\</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;0 &amp; I</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;\end{matrix}</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;\right]</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;\left(</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;\begin{matrix}</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;u^* \\</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;\tilde{f}</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;\end{matrix}</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;\right)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;=</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;\left[</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;\begin{matrix}</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;A &amp; 0 \\</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;E &amp; -EA^{-1}H</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;\end{matrix}</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;\right]</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;\left(</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;\begin{matrix}</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;u^{* *} \\</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;\tilde{f}</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;\end{matrix}</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;\right)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;=</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;\left(</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;\begin{matrix}</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;r^n + bc_1 \\</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;u_B^{n+1}</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;\end{matrix}</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;\right)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;\end{equation}</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;and we end up with the following sequence:</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;\begin{align}</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;&amp; A u^{* *} = r^n + bc_1 \\</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;&amp; EA^{-1}H \tilde{f} = E u^{* *} - u_B^{n+1} \\</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;&amp; u^* = u^{* *} - A^{-1}H \tilde{f}</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;\end{align}</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;The decoupled version of the IBPM implemented in PetIBM solves, at every time step, Equations (15) to (17) followed by Equations (12) and (13).</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;# References</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dc/d64/paper_8md.html">paper.md</a></li>
    <li class="footer">Generated on Fri Jun 22 2018 12:14:35 for PetIBM by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
