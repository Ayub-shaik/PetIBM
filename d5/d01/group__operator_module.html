<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PetIBM: Operator factories</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PetIBM
   &#160;<span id="projectnumber">0.3</span>
   </div>
   <div id="projectbrief">Toolbox and applications of the immersed-boundary method for distributed-memory architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/d01/group__operator_module.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Operator factories<div class="ingroups"><a class="el" href="../../da/d34/group__petibm.html">PetIBM building blocks</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Matrices &amp; Operators used in Perot's framework (1993, 2002).  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Operator factories:</div>
<div class="dyncontent">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d01/group__operator_module.svg" width="343" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:da/d84/namespacepetibm_1_1operators"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d84/namespacepetibm_1_1operators.html">petibm::operators</a></td></tr>
<tr class="memdesc:da/d84/namespacepetibm_1_1operators"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collections of factory functions of operators. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gafd24a451c19a23309e7c54c9d5268ed4"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#gafd24a451c19a23309e7c54c9d5268ed4">petibm::operators::createR</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, Mat &amp;R)</td></tr>
<tr class="memdesc:gafd24a451c19a23309e7c54c9d5268ed4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a matrix of flux areas, <img class="formulaInl" alt="$R$" src="../../form_16.png"/>.  <a href="../../d5/d01/group__operator_module.html#gafd24a451c19a23309e7c54c9d5268ed4">More...</a><br /></td></tr>
<tr class="separator:gafd24a451c19a23309e7c54c9d5268ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0bc76dd498f8f501ad63664353ffc157"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga0bc76dd498f8f501ad63664353ffc157">petibm::operators::createRInv</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, Mat &amp;RInv)</td></tr>
<tr class="memdesc:ga0bc76dd498f8f501ad63664353ffc157"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a matrix of inversed flux areas, <img class="formulaInl" alt="$R^{-1}$" src="../../form_20.png"/>.  <a href="../../d5/d01/group__operator_module.html#ga0bc76dd498f8f501ad63664353ffc157">More...</a><br /></td></tr>
<tr class="separator:ga0bc76dd498f8f501ad63664353ffc157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga161f1524b5073fdfa35f21d62aaec92d"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga161f1524b5073fdfa35f21d62aaec92d">petibm::operators::createMHead</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, Mat &amp;MHead)</td></tr>
<tr class="memdesc:ga161f1524b5073fdfa35f21d62aaec92d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a matrix of cell widths of velocity points, <img class="formulaInl" alt="$\hat{M}$" src="../../form_22.png"/>.  <a href="../../d5/d01/group__operator_module.html#ga161f1524b5073fdfa35f21d62aaec92d">More...</a><br /></td></tr>
<tr class="separator:ga161f1524b5073fdfa35f21d62aaec92d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga99466a5f168ace85cd8e28b35ae135f5"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga99466a5f168ace85cd8e28b35ae135f5">petibm::operators::createM</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, Mat &amp;M)</td></tr>
<tr class="memdesc:ga99466a5f168ace85cd8e28b35ae135f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a matrix <img class="formulaInl" alt="$M=\hat{M}R^{-1}$" src="../../form_28.png"/>.  <a href="../../d5/d01/group__operator_module.html#ga99466a5f168ace85cd8e28b35ae135f5">More...</a><br /></td></tr>
<tr class="separator:ga99466a5f168ace85cd8e28b35ae135f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f4beb7b401a427e496c34907c810d2e"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga7f4beb7b401a427e496c34907c810d2e">petibm::operators::createIdentity</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, Mat &amp;I)</td></tr>
<tr class="memdesc:ga7f4beb7b401a427e496c34907c810d2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an identity matrix <img class="formulaInl" alt="$I$" src="../../form_30.png"/> for velocity fields.  <a href="../../d5/d01/group__operator_module.html#ga7f4beb7b401a427e496c34907c810d2e">More...</a><br /></td></tr>
<tr class="separator:ga7f4beb7b401a427e496c34907c810d2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ca31641fbf44616692fb3f03e15b68c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga8ca31641fbf44616692fb3f03e15b68c">petibm::operators::createGradient</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, Mat &amp;G, const PetscBool &amp;normalize=PETSC_TRUE)</td></tr>
<tr class="memdesc:ga8ca31641fbf44616692fb3f03e15b68c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a gradient operator, <img class="formulaInl" alt="$G$" src="../../form_31.png"/>, for pressure field.  <a href="../../d5/d01/group__operator_module.html#ga8ca31641fbf44616692fb3f03e15b68c">More...</a><br /></td></tr>
<tr class="separator:ga8ca31641fbf44616692fb3f03e15b68c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga255cbdcfe47b97a2708e1c08343411a7"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga255cbdcfe47b97a2708e1c08343411a7">petibm::operators::createDivergence</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, const <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">type::Boundary</a> &amp;bc, Mat &amp;D, Mat &amp;DCorrection, const PetscBool &amp;normalize=PETSC_TRUE)</td></tr>
<tr class="memdesc:ga255cbdcfe47b97a2708e1c08343411a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a divergence operator, <img class="formulaInl" alt="$D$" src="../../form_9.png"/>, and corresponding boundary correction, <img class="formulaInl" alt="$D_{bc}$" src="../../form_10.png"/>, for velocity fields.  <a href="../../d5/d01/group__operator_module.html#ga255cbdcfe47b97a2708e1c08343411a7">More...</a><br /></td></tr>
<tr class="separator:ga255cbdcfe47b97a2708e1c08343411a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93d7912d360b3b2ae30ff6cb29b733a1"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga93d7912d360b3b2ae30ff6cb29b733a1">petibm::operators::createLaplacian</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, const <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">type::Boundary</a> &amp;bc, Mat &amp;L, Mat &amp;LCorrection)</td></tr>
<tr class="memdesc:ga93d7912d360b3b2ae30ff6cb29b733a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a Laplacian operator, <img class="formulaInl" alt="$L$" src="../../form_33.png"/>, and boundary correction, <img class="formulaInl" alt="$L_{bc}$" src="../../form_34.png"/> for velocity fields.  <a href="../../d5/d01/group__operator_module.html#ga93d7912d360b3b2ae30ff6cb29b733a1">More...</a><br /></td></tr>
<tr class="separator:ga93d7912d360b3b2ae30ff6cb29b733a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada96f41086e1e23b93633321702af76b"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#gada96f41086e1e23b93633321702af76b">petibm::operators::createConvection</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, const <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">type::Boundary</a> &amp;bc, Mat &amp;H)</td></tr>
<tr class="memdesc:gada96f41086e1e23b93633321702af76b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a matrix-free Mat for convection operator, <img class="formulaInl" alt="$H$" src="../../form_36.png"/>.  <a href="../../d5/d01/group__operator_module.html#gada96f41086e1e23b93633321702af76b">More...</a><br /></td></tr>
<tr class="separator:gada96f41086e1e23b93633321702af76b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe361a4fc3dfda999f1b8cd9eb4c92b6"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#gabe361a4fc3dfda999f1b8cd9eb4c92b6">petibm::operators::createBnHead</a> (const Mat &amp;Op, const PetscReal &amp;dt, const PetscReal &amp;coeff, const PetscInt &amp;n, Mat &amp;BnHead)</td></tr>
<tr class="memdesc:gabe361a4fc3dfda999f1b8cd9eb4c92b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create non-normalized matrix of approximated <img class="formulaInl" alt="$A^{-1}$" src="../../form_38.png"/>, <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>.  <a href="../../d5/d01/group__operator_module.html#gabe361a4fc3dfda999f1b8cd9eb4c92b6">More...</a><br /></td></tr>
<tr class="separator:gabe361a4fc3dfda999f1b8cd9eb4c92b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c146c5e8d54f9b1c9bec6083419aec5"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga1c146c5e8d54f9b1c9bec6083419aec5">petibm::operators::createBn</a> (const Mat &amp;Op, const Mat &amp;R, const Mat &amp;MHead, const PetscReal &amp;dt, const PetscReal &amp;coeff, const PetscInt &amp;n, Mat &amp;Bn)</td></tr>
<tr class="memdesc:ga1c146c5e8d54f9b1c9bec6083419aec5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create normalized matrix of approximated <img class="formulaInl" alt="$A^{-1}$" src="../../form_38.png"/>, <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>.  <a href="../../d5/d01/group__operator_module.html#ga1c146c5e8d54f9b1c9bec6083419aec5">More...</a><br /></td></tr>
<tr class="separator:ga1c146c5e8d54f9b1c9bec6083419aec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5b89e03619afe7ef24ccf983444d7f31"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#ga5b89e03619afe7ef24ccf983444d7f31">petibm::operators::createBn</a> (const Mat &amp;Op, const Mat &amp;M, const PetscReal &amp;dt, const PetscReal &amp;coeff, const PetscInt &amp;n, Mat &amp;Bn)</td></tr>
<tr class="memdesc:ga5b89e03619afe7ef24ccf983444d7f31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create normalized matrix of approximated <img class="formulaInl" alt="$A^{-1}$" src="../../form_38.png"/>, <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>.  <a href="../../d5/d01/group__operator_module.html#ga5b89e03619afe7ef24ccf983444d7f31">More...</a><br /></td></tr>
<tr class="separator:ga5b89e03619afe7ef24ccf983444d7f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb0fb04830cf6c8cc0bea96e95747fc2"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d01/group__operator_module.html#gafb0fb04830cf6c8cc0bea96e95747fc2">petibm::operators::createDelta</a> (const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;mesh, const <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">type::Boundary</a> &amp;bc, const <a class="el" href="../../d0/d1a/group__body_module.html#ga5da969fd68a7d5f758404d6cb8be464b">type::BodyPack</a> &amp;bodies, Mat &amp;Delta)</td></tr>
<tr class="memdesc:gafb0fb04830cf6c8cc0bea96e95747fc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a Delta operator, <img class="formulaInl" alt="$Delta$" src="../../form_54.png"/>.  <a href="../../d5/d01/group__operator_module.html#gafb0fb04830cf6c8cc0bea96e95747fc2">More...</a><br /></td></tr>
<tr class="separator:gafb0fb04830cf6c8cc0bea96e95747fc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Matrices &amp; Operators used in Perot's framework (1993, 2002). </p>
<p>An operator is a matrix, which will be the type of PETSc Mat. It may be a sparse matrix or a matrix-free matrix. Operators in CFD are based on the discretization of domain and boundary conditions, i.e. mesh. Therefore, all operator factories require a <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">Mesh</a> instance as an input, and most of them require a <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">Boundary</a> instance as another input.</p>
<p>Given that PetIBM now only supports staggered grid, most of the operators only make sense to staggered Cartesian CFD methods. So the operator factories can not create the operators for arbitrary fields. For example, <a class="el" href="../../d5/d01/group__operator_module.html#ga93d7912d360b3b2ae30ff6cb29b733a1">createLaplacian</a> can only create Laplacian for velocity fields because in our CFD framework (Perot 1993), only the Laplacian of velocity fields is required. This factory function cannot create Laplacian operators for arbitrary fields.</p>
<p>For operators taking boundary conditions, we decouple the interior part and boundary corrections. For example, applying a divergence operator to velocity will become </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[(D + D_{bc})u\]" src="../../form_8.png"/>
</p>
<p> in which <img class="formulaInl" alt="$D$" src="../../form_9.png"/> and <img class="formulaInl" alt="$D_{bc}$" src="../../form_10.png"/> represent divergence operators of interior points and ghost points (i.e., boundary correction), respectively.</p>
<p>Boundary conditions in PetIBM are implemented with ghost point schemes. Most of boundary conditions can be represented with, for example, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_{i} = a_{0} u_{i-1} + a_{1} \]" src="../../form_11.png"/>
</p>
<p> where <img class="formulaInl" alt="$u_{i}$" src="../../form_12.png"/> and <img class="formulaInl" alt="$u_{i-1}$" src="../../form_13.png"/> represent a ghost point and its corresponding interior point, respectively. Hence when we apply ghost point schemes to operators, the <img class="formulaInl" alt="$a_{0}$" src="../../form_14.png"/> part will get into the interior operator (e.g. <img class="formulaInl" alt="$D$" src="../../form_9.png"/>), and the <img class="formulaInl" alt="$a_{1}$" src="../../form_15.png"/> part will be decoupled into the boundary correction matrix, i.e., <img class="formulaInl" alt="$D_{bc}$" src="../../form_10.png"/>.</p>
<p>Here is an example code for creating a divergence operator and its boundary correction operator, and calculating the divergence of velocity.</p>
<div class="fragment"><div class="line">PetscErrorCode ierr;</div><div class="line">Mat D, Dbc;</div><div class="line">Vec div;</div><div class="line"><a class="code" href="../../dd/df7/group__solution_module.html#ga39e1133c9861c6f23b180013e3c04174">petibm::type::Solution</a> solution;</div><div class="line"><a class="code" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">petibm::type::Mesh</a> mesh;</div><div class="line"><a class="code" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">petibm::type::Boundary</a> boundary;</div><div class="line"><a class="code" href="../../dd/df7/group__solution_module.html#ga39e1133c9861c6f23b180013e3c04174">petibm::type::Solution</a> solution;</div><div class="line"></div><div class="line"><span class="comment">// create mesh with petibm::mesh::createMesh</span></div><div class="line"><span class="comment">// create boundary with petibm::boundary::createBoundary</span></div><div class="line"><span class="comment">// create solution with petibm::solution::createSolution, and have some values </span></div><div class="line"><span class="comment">// create vector div with correct memory allocation</span></div><div class="line"></div><div class="line"><span class="comment">// create divergence operator</span></div><div class="line">ierr = <a class="code" href="../../d5/d01/group__operator_module.html#ga255cbdcfe47b97a2708e1c08343411a7">petibm::createDivergence</a>(mesh, boundary, D, Dbc); CHKERRQ(ierr);</div><div class="line"></div><div class="line"><span class="comment">// calculate divergence of velocity, result will be in div</span></div><div class="line">ierr = MatMult(D, solution-&gt;UGlobal, div); CHKERRQ(ierr);</div><div class="line">ierr = MatMultAdd(Dbc, solution-&gt;UGlobal, div, div); CHKERRQ(ierr);</div></div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="ga1c146c5e8d54f9b1c9bec6083419aec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1c146c5e8d54f9b1c9bec6083419aec5">&#9670;&nbsp;</a></span>createBn() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createBn </td>
          <td>(</td>
          <td class="paramtype">const Mat &amp;&#160;</td>
          <td class="paramname"><em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Mat &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Mat &amp;&#160;</td>
          <td class="paramname"><em>MHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscInt &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Bn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create normalized matrix of approximated <img class="formulaInl" alt="$A^{-1}$" src="../../form_38.png"/>, <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Op</td><td>[in] a PETSc Mat; implicit operator. </td></tr>
    <tr><td class="paramname">R</td><td>[in] the normalization matrix to define <img class="formulaInl" alt="$M = \hat{M}R^{-1}$" src="../../form_49.png"/>. </td></tr>
    <tr><td class="paramname">MHead</td><td>[in] the normalization matrix to define <img class="formulaInl" alt="$M = \hat{M}R^{-1}$" src="../../form_49.png"/>. </td></tr>
    <tr><td class="paramname">dt</td><td>[in] size of a time step. </td></tr>
    <tr><td class="paramname">coeff</td><td>[in] coefficient of temporal integration for implicit operator. </td></tr>
    <tr><td class="paramname">n</td><td>[in] an integer; the order of <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>. </td></tr>
    <tr><td class="paramname">Bn</td><td>[out] a PETSc Mat; returned matrix, <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>Similar to <a class="el" href="../../d5/d01/group__operator_module.html#gabe361a4fc3dfda999f1b8cd9eb4c92b6">createBnHead</a>, except that A is now defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \frac{M}{dt} - coeff \times \hat{M}OpR \]" src="../../form_50.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ M = \hat{M}R^{-1} \]" src="../../form_51.png"/>
</p>
 
<p class="definition">Definition at line <a class="el" href="../../db/db8/createbn_8cpp_source.html#l00099">99</a> of file <a class="el" href="../../db/db8/createbn_8cpp_source.html">createbn.cpp</a>.</p>

</div>
</div>
<a id="ga5b89e03619afe7ef24ccf983444d7f31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5b89e03619afe7ef24ccf983444d7f31">&#9670;&nbsp;</a></span>createBn() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createBn </td>
          <td>(</td>
          <td class="paramtype">const Mat &amp;&#160;</td>
          <td class="paramname"><em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Mat &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscInt &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Bn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create normalized matrix of approximated <img class="formulaInl" alt="$A^{-1}$" src="../../form_38.png"/>, <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Op</td><td>[in] a PETSc Mat; implicit operator. </td></tr>
    <tr><td class="paramname">M</td><td>[in] the <img class="formulaInl" alt="$M$" src="../../form_29.png"/> matrix as defined in <img class="formulaInl" alt="$A = M/dt - coeff * Op$" src="../../form_52.png"/>. </td></tr>
    <tr><td class="paramname">dt</td><td>[in] size of a time step. </td></tr>
    <tr><td class="paramname">coeff</td><td>[in] coefficient of temporal integration for implicit operator. </td></tr>
    <tr><td class="paramname">n</td><td>[in] an integer; the order of Bn. </td></tr>
    <tr><td class="paramname">Bn</td><td>[out] returned matrix, <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>Similar to <a class="el" href="../../d5/d01/group__operator_module.html#gabe361a4fc3dfda999f1b8cd9eb4c92b6">createBnHead</a>, except that A is now defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \frac{M}{dt} - coeff \times Op \]" src="../../form_53.png"/>
</p>
 
<p class="definition">Definition at line <a class="el" href="../../db/db8/createbn_8cpp_source.html#l00133">133</a> of file <a class="el" href="../../db/db8/createbn_8cpp_source.html">createbn.cpp</a>.</p>

</div>
</div>
<a id="gabe361a4fc3dfda999f1b8cd9eb4c92b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe361a4fc3dfda999f1b8cd9eb4c92b6">&#9670;&nbsp;</a></span>createBnHead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createBnHead </td>
          <td>(</td>
          <td class="paramtype">const Mat &amp;&#160;</td>
          <td class="paramname"><em>Op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscInt &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>BnHead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create non-normalized matrix of approximated <img class="formulaInl" alt="$A^{-1}$" src="../../form_38.png"/>, <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Op</td><td>[in] a PETSc Mat; implicit operator. </td></tr>
    <tr><td class="paramname">dt</td><td>[in] size of a time step. </td></tr>
    <tr><td class="paramname">coeff</td><td>[in] coefficient of temporal integration for implicit operator. </td></tr>
    <tr><td class="paramname">n</td><td>[in] integer; the order of Bn. </td></tr>
    <tr><td class="paramname">BnHead</td><td>[out] returned <img class="formulaInl" alt="$B_n$" src="../../form_39.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p><img class="formulaInl" alt="$A$" src="../../form_40.png"/> is defined as * </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[A=\frac{I}{dt} - coeff \times Op\]" src="../../form_41.png"/>
</p>
<p> where <img class="formulaInl" alt="$I$" src="../../form_30.png"/> is an identity matrix, <img class="formulaInl" alt="$Op$" src="../../form_42.png"/> is the summation of all implicit operators, and <img class="formulaInl" alt="$coeff$" src="../../form_43.png"/> is the coefficient from temporal integration. For example, for the case of Adams-Bashforth for convective terms and Crank-Nicolson for diffusion term, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[A = \frac{I}{dt} - 0.5 \times L\]" src="../../form_44.png"/>
</p>
<p>If the implicit part is more complicated, there may be not only one coefficient for each implicit operator. Then, in order to use this function, we may need to incorporate coefficients and all implicit operators into a big implicit operator before calling this function. And then set <img class="formulaInl" alt="$coeff$" src="../../form_43.png"/> as <img class="formulaInl" alt="$1$" src="../../form_45.png"/>. For example, if an <img class="formulaInl" alt="$A$" src="../../form_40.png"/> is defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \frac{I}{dt} - c_{1}\times Op_{1} - c_{2}\times Op_{2}\]" src="../../form_46.png"/>
</p>
<p> then we need to first define </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[Op = c_1\times Op_1 + c_2\times Op_2\]" src="../../form_47.png"/>
</p>
<p> so that <img class="formulaInl" alt="$A$" src="../../form_40.png"/> can have the form of </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \frac{I}{dt} - 1.0\times Op \]" src="../../form_48.png"/>
</p>
<p>. </p>

<p class="definition">Definition at line <a class="el" href="../../db/db8/createbn_8cpp_source.html#l00023">23</a> of file <a class="el" href="../../db/db8/createbn_8cpp_source.html">createbn.cpp</a>.</p>

</div>
</div>
<a id="gada96f41086e1e23b93633321702af76b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada96f41086e1e23b93633321702af76b">&#9670;&nbsp;</a></span>createConvection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createConvection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">type::Boundary</a> &amp;&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>H</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a matrix-free Mat for convection operator, <img class="formulaInl" alt="$H$" src="../../form_36.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">bc</td><td>[in] an instance of <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c" title="Type definition of petibm::type::Boundary. ">petibm::type::Boundary</a>. </td></tr>
    <tr><td class="paramname">H</td><td>[out] a PETSc Mat; the returned operator, <img class="formulaInl" alt="$H$" src="../../form_36.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>Though this matrix-free operator is a PETSc Mat, not all PETSc Mat functions can be applied to it because we only register MatMult and MatDestroy functions in PetIBM.</p>
<p>If <img class="formulaInl" alt="$u$" src="../../form_18.png"/> is the composite velocity vector, then the multiplication <img class="formulaInl" alt="$Hu$" src="../../form_37.png"/> will return the convection terms at velocity points. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d4d/createconvection_8cpp_source.html#l00094">94</a> of file <a class="el" href="../../da/d4d/createconvection_8cpp_source.html">createconvection.cpp</a>.</p>

</div>
</div>
<a id="gafb0fb04830cf6c8cc0bea96e95747fc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafb0fb04830cf6c8cc0bea96e95747fc2">&#9670;&nbsp;</a></span>createDelta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createDelta </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">type::Boundary</a> &amp;&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1a/group__body_module.html#ga5da969fd68a7d5f758404d6cb8be464b">type::BodyPack</a> &amp;&#160;</td>
          <td class="paramname"><em>bodies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a Delta operator, <img class="formulaInl" alt="$Delta$" src="../../form_54.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">bc</td><td>[in] an instance of <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c" title="Type definition of petibm::type::Boundary. ">petibm::type::Boundary</a>. </td></tr>
    <tr><td class="paramname">bodies</td><td>[in] an instance of <a class="el" href="../../d0/d1a/group__body_module.html#ga5da969fd68a7d5f758404d6cb8be464b" title="Definition of type::BodyPack. ">petibm::type::BodyPack</a>. </td></tr>
    <tr><td class="paramname">Delta</td><td>[out] a PETSc Mat; returned <img class="formulaInl" alt="$Delta$" src="../../form_54.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>In <img class="formulaInl" alt="$Delta$" src="../../form_54.png"/>, rows represent Lagrangian points, while columns represent velocity mesh points.</p>
<p>An entry in <img class="formulaInl" alt="$Delta$" src="../../form_54.png"/>, says <img class="formulaInl" alt="$Delta_{(i,j)}$" src="../../form_55.png"/>, is defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Delta_{(i,j)} = d(x_j-\xi_i)d(y_j-\eta_i)d(z_j-\zeta_i) \]" src="../../form_56.png"/>
</p>
<p> where <img class="formulaInl" alt="$(x_j,y_j,z_j)$" src="../../form_57.png"/> and <img class="formulaInl" alt="$(\xi_i,\eta_i,\zeta_i)$" src="../../form_58.png"/> represent the coordinates of the <img class="formulaInl" alt="$j$" src="../../form_59.png"/>-th Eulerian grid point and the <img class="formulaInl" alt="$i$" src="../../form_60.png"/>-th Lagrangian point, respectively. <img class="formulaInl" alt="$d(...)$" src="../../form_61.png"/> is discretized delta function following Roma et. al. (1999). </p>

<p class="definition">Definition at line <a class="el" href="../../da/df5/createdelta_8cpp_source.html#l00043">43</a> of file <a class="el" href="../../da/df5/createdelta_8cpp_source.html">createdelta.cpp</a>.</p>

</div>
</div>
<a id="ga255cbdcfe47b97a2708e1c08343411a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga255cbdcfe47b97a2708e1c08343411a7">&#9670;&nbsp;</a></span>createDivergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createDivergence </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">type::Boundary</a> &amp;&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>DCorrection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscBool &amp;&#160;</td>
          <td class="paramname"><em>normalize</em> = <code>PETSC_TRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a divergence operator, <img class="formulaInl" alt="$D$" src="../../form_9.png"/>, and corresponding boundary correction, <img class="formulaInl" alt="$D_{bc}$" src="../../form_10.png"/>, for velocity fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">bc</td><td>[in] an instance of <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c" title="Type definition of petibm::type::Boundary. ">petibm::type::Boundary</a>. </td></tr>
    <tr><td class="paramname">D</td><td>[out] a PETSc Mat; returned divergence operator, <img class="formulaInl" alt="$D$" src="../../form_9.png"/>. </td></tr>
    <tr><td class="paramname">DCorrection</td><td>[out] a PETSc Mat; returned boundary correction, <img class="formulaInl" alt="$D_{bc}$" src="../../form_10.png"/>. </td></tr>
    <tr><td class="paramname">normalize</td><td>[in] an optional PetscBool indicating whether or not we want normalization (default is PETSC_TRUE). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>PETSc matrix D should not be created before calling this function.</p>
<p>If <code>normalize=PETSC_TRUE</code> (which is default), then the divergence operator, <img class="formulaInl" alt="$D$" src="../../form_9.png"/>, will only contain <code>0</code> and <code>1</code>.</p>
<p>The divergence operator calculates the divergence of velocity on pressure points. The complete divergence operator is <img class="formulaInl" alt="$(D+D_{bc})$" src="../../form_32.png"/>. However, the boundary correction, <img class="formulaInl" alt="$D_{bc}$" src="../../form_10.png"/>, represents the constant coefficients (it means the coefficients that have nothing to do with interior points, though it may still be time-dependent) in ghost point schemes, so it's safe to put the boundary correction to right-hand side in a linear system. </p>

<p class="definition">Definition at line <a class="el" href="../../de/d1a/createdivergence_8cpp_source.html#l00057">57</a> of file <a class="el" href="../../de/d1a/createdivergence_8cpp_source.html">createdivergence.cpp</a>.</p>

</div>
</div>
<a id="ga8ca31641fbf44616692fb3f03e15b68c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ca31641fbf44616692fb3f03e15b68c">&#9670;&nbsp;</a></span>createGradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createGradient </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscBool &amp;&#160;</td>
          <td class="paramname"><em>normalize</em> = <code>PETSC_TRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a gradient operator, <img class="formulaInl" alt="$G$" src="../../form_31.png"/>, for pressure field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">G</td><td>[out] a PETSc Mat; returned gradient operator, <img class="formulaInl" alt="$G$" src="../../form_31.png"/>. </td></tr>
    <tr><td class="paramname">normalize</td><td>[in] an optional PetscBool indicating whether or not we want normalization (default is PETSC_TRUE). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>Petsc matrix G should not be created before calling this function.</p>
<p>If <code>normalize=PETSC_TRUE</code> (which is default), then the gradient operator, <img class="formulaInl" alt="$G$" src="../../form_31.png"/>, will only contain <code>0</code> and <code>1</code>.</p>
<p>This gradient operator doesn't require boundary conditions because we only need gradient of pressure at interior velocity points (see Perot 1993). And it can only be applied to pressure field. For example: </p><div class="fragment"><div class="line">ierr = <a class="code" href="../../d5/d01/group__operator_module.html#ga8ca31641fbf44616692fb3f03e15b68c">petibm::operators::createGradient</a>(mesh, G); CHKERRQ(ierr);</div><div class="line">ierr = MatMult(G, solution-&gt;pGlobal, grad); CHKERRQ(ierr);</div></div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="../../df/d7f/creategradient_8cpp_source.html#l00041">41</a> of file <a class="el" href="../../df/d7f/creategradient_8cpp_source.html">creategradient.cpp</a>.</p>

</div>
</div>
<a id="ga7f4beb7b401a427e496c34907c810d2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f4beb7b401a427e496c34907c810d2e">&#9670;&nbsp;</a></span>createIdentity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createIdentity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>I</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an identity matrix <img class="formulaInl" alt="$I$" src="../../form_30.png"/> for velocity fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">I</td><td>[out] a PETSc Mat; returned matrix <img class="formulaInl" alt="$I$" src="../../form_30.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>PETSc matrix I should not be created before calling this function. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html#l00194">194</a> of file <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html">creatediagmatrix.cpp</a>.</p>

</div>
</div>
<a id="ga93d7912d360b3b2ae30ff6cb29b733a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga93d7912d360b3b2ae30ff6cb29b733a1">&#9670;&nbsp;</a></span>createLaplacian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createLaplacian </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c">type::Boundary</a> &amp;&#160;</td>
          <td class="paramname"><em>bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>LCorrection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a Laplacian operator, <img class="formulaInl" alt="$L$" src="../../form_33.png"/>, and boundary correction, <img class="formulaInl" alt="$L_{bc}$" src="../../form_34.png"/> for velocity fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">bc</td><td>[in] an instance of <a class="el" href="../../d1/d84/group__boundary_module.html#gab010687f690b655fdba72865b07bab7c" title="Type definition of petibm::type::Boundary. ">petibm::type::Boundary</a>. </td></tr>
    <tr><td class="paramname">L</td><td>[out] a PETSc Mat; returned Laplacian, <img class="formulaInl" alt="$L$" src="../../form_33.png"/>. </td></tr>
    <tr><td class="paramname">LCorrection</td><td>[out] a PETSc Mat; returned boundary correction, <img class="formulaInl" alt="$L_{bc}$" src="../../form_34.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>PETSc matrix L should not be created before calling this function.</p>
<p>The complete Laplacian is <img class="formulaInl" alt="$(L+L_{bc})$" src="../../form_35.png"/>. The boundary correction represents the constant coefficients (the coefficients that have nothing to do with interior velocity points) in ghost point schemes. So it's often seen the boundary correction <img class="formulaInl" alt="$L_{bc}$" src="../../form_34.png"/> on right-hand side of a system, while <img class="formulaInl" alt="$L$" src="../../form_33.png"/> on left-hand side. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d05/createlaplacian_8cpp_source.html#l00084">84</a> of file <a class="el" href="../../d1/d05/createlaplacian_8cpp_source.html">createlaplacian.cpp</a>.</p>

</div>
</div>
<a id="ga99466a5f168ace85cd8e28b35ae135f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga99466a5f168ace85cd8e28b35ae135f5">&#9670;&nbsp;</a></span>createM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createM </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>M</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a matrix <img class="formulaInl" alt="$M=\hat{M}R^{-1}$" src="../../form_28.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">M</td><td>[out] a PETSc Mat; returned matrix <img class="formulaInl" alt="$M$" src="../../form_29.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>PETSc matrix M should not be created before calling this function.</p>
<p>In some CFD schemes, the combination of <img class="formulaInl" alt="$\hat{M}$" src="../../form_22.png"/> and <img class="formulaInl" alt="$R^{-1}$" src="../../form_20.png"/> is used frequently. So this function creates a matrix <img class="formulaInl" alt="$M=\hat{M}R^{-1}$" src="../../form_28.png"/> for convenience. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html#l00169">169</a> of file <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html">creatediagmatrix.cpp</a>.</p>

</div>
</div>
<a id="ga161f1524b5073fdfa35f21d62aaec92d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga161f1524b5073fdfa35f21d62aaec92d">&#9670;&nbsp;</a></span>createMHead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createMHead </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>MHead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a matrix of cell widths of velocity points, <img class="formulaInl" alt="$\hat{M}$" src="../../form_22.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">MHead</td><td>[out] a PETSc Mat; returned matrix <img class="formulaInl" alt="$\hat{M}$" src="../../form_22.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>PETSc matrix MHead should not be created before calling this function.</p>
<p>Operator <img class="formulaInl" alt="$\hat{M}$" src="../../form_22.png"/> represents the cell width of velocity points. The cell width of a <img class="formulaInl" alt="$u$" src="../../form_18.png"/>-velocity point with index <img class="formulaInl" alt="$(i, j, k)$" src="../../form_23.png"/>, for example, is <img class="formulaInl" alt="$dx_{i,j,k}$" src="../../form_24.png"/>, and the cell width of <img class="formulaInl" alt="$v$" src="../../form_25.png"/>-velocity at <img class="formulaInl" alt="$(i, j, k)$" src="../../form_23.png"/> is <img class="formulaInl" alt="$dy_{i,j,k}$" src="../../form_26.png"/>.</p>
<p>The multiplication of <img class="formulaInl" alt="$\hat{M}$" src="../../form_22.png"/> and <img class="formulaInl" alt="$R$" src="../../form_16.png"/> returns the cell volumes of velocity points, i.e., <img class="formulaInl" alt="$\hat{M}R=cell\ volumes$" src="../../form_27.png"/>. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html#l00144">144</a> of file <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html">creatediagmatrix.cpp</a>.</p>

</div>
</div>
<a id="gafd24a451c19a23309e7c54c9d5268ed4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafd24a451c19a23309e7c54c9d5268ed4">&#9670;&nbsp;</a></span>createR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a matrix of flux areas, <img class="formulaInl" alt="$R$" src="../../form_16.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">R</td><td>[out] a PETSc Mat; returned matrix <img class="formulaInl" alt="$R$" src="../../form_16.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>PETSc matrix R should not be created before calling this function.</p>
<p>Operator <img class="formulaInl" alt="$R$" src="../../form_16.png"/> represents the flux areas of velocity points. For example, if <img class="formulaInl" alt="$q$" src="../../form_17.png"/> is vector of velocity flux, and <img class="formulaInl" alt="$u$" src="../../form_18.png"/> is velocity vector, then <img class="formulaInl" alt="$Rq=u$" src="../../form_19.png"/>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d5/d01/group__operator_module.html#ga0bc76dd498f8f501ad63664353ffc157" title="Create a matrix of inversed flux areas, . ">petibm::operators::createRInv</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html#l00094">94</a> of file <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html">creatediagmatrix.cpp</a>.</p>

</div>
</div>
<a id="ga0bc76dd498f8f501ad63664353ffc157"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0bc76dd498f8f501ad63664353ffc157">&#9670;&nbsp;</a></span>createRInv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode petibm::operators::createRInv </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309">type::Mesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>RInv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a matrix of inversed flux areas, <img class="formulaInl" alt="$R^{-1}$" src="../../form_20.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>[in] an instance of <a class="el" href="../../d7/d24/group__mesh_module.html#ga50d3a91e4c3aec2b2b0444187d1cf309" title="Type definition of Mesh. ">petibm::type::Mesh</a>. </td></tr>
    <tr><td class="paramname">RInv</td><td>[out] a PETSc Mat; returned matrix <img class="formulaInl" alt="$R^{-1}$" src="../../form_20.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode.</dd></dl>
<p>PETSc matrix RInv should not be created before calling this function.</p>
<p>Operator <img class="formulaInl" alt="$R^{-1}$" src="../../form_20.png"/> is the inverse of <img class="formulaInl" alt="$R$" src="../../form_16.png"/>. And it has relationship <img class="formulaInl" alt="$R^{-1}u=q$" src="../../form_21.png"/>, in which <img class="formulaInl" alt="$u$" src="../../form_18.png"/> and <img class="formulaInl" alt="$q$" src="../../form_17.png"/> are as defined in <a class="el" href="../../d5/d01/group__operator_module.html#gafd24a451c19a23309e7c54c9d5268ed4" title="Create a matrix of flux areas, . ">petibm::operators::createR</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d5/d01/group__operator_module.html#gafd24a451c19a23309e7c54c9d5268ed4" title="Create a matrix of flux areas, . ">petibm::operators::createR</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html#l00119">119</a> of file <a class="el" href="../../d1/d45/creatediagmatrix_8cpp_source.html">creatediagmatrix.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jan 26 2018 12:29:04 for PetIBM by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
